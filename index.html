<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- Visual appearance -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="static/tidyblocks.css" rel="stylesheet" type="text/css">

  </head>
  <body>
  
    <div id="codeArea">
      <button id="blockToText" onclick="generateCodePane(); showCode();">
        Block to Text
        <i class="fa fa-bug"></i>
      </button>
      <button id="runCode" onclick="runCode()">
        Run Code
        <i class="fa fa-play"></i>
      </button>
      <div class="input" id="blockDisplay">
        <xml id="toolbox">
          <category name="data" categorystyle="data">
            <block type="data_colors"></block>
            <block type="data_earthquakes"></block>
            <block type="data_iris"></block>
            <block type="data_mtcars"></block>
            <block type="data_toothGrowth"></block>
            <block type="data_unit"></block>
            <block type="data_urlCSV"></block>
          </category>
          <category name="dplyr" categorystyle="dplyr">
            <block type="dplyr_filter"></block>
            <block type="dplyr_groupby"></block>
            <block type="dplyr_mutate"></block>
            <block type="dplyr_select"></block>
            <block type="dplyr_summarize"></block>
          </category>
          <category name="ggplot" categorystyle="ggplot">
            <block type="ggplot_bar"></block>
            <block type="ggplot_boxplot"></block>
            <block type="ggplot_hist"></block>
            <block type="ggplot_point"></block>
            <block type="ggplot_table"></block>
          </category>
          <category name="plumbing" categorystyle="plumbing">
            <block type="plumbing_join"></block>
            <block type="plumbing_notify"></block>
          </category>
          <category name="stats" categorystyle="stats">
            <block type="stats_arithmetic"></block>
            <block type="stats_count"></block>
            <block type="stats_max"></block>
            <block type="stats_mean"></block>
            <block type="stats_median"></block>
            <block type="stats_min"></block>
            <block type="stats_sd"></block>
            <block type="stats_sum"></block>
          </category>
          <category name="variables" categorystyle="variables">
            <block type="variable_column"></block>
            <block type="variable_compare"></block>
            <block type="variable_number"></block>
            <block type="variable_logical"></block>
            <block type="variable_text"></block>
            <block type="variable_columns"></block>
          </category>
        </xml>
      </div>
      <div class="input" id="codeOutputDiv">
        <pre id="codeOutput"></pre>
      </div>
    </div>
    
    <div id="displayArea">
      <div class="output" id="plotOutput">
        Plot Output
      </div>
      <div class="output" id="dataOutput">
        Data Output
      </div>
    </div>

    <!-- Blockly itself -->
    <script language="javascript" type="text/javascript" src="blockly/blockly_compressed.js"></script>
    <script language="javascript" type="text/javascript" src="blockly/blocks_compressed.js"></script>
    <script language="javascript" type="text/javascript" src="blockly/javascript_compressed.js"></script>
    <script language="javascript" type="text/javascript" src="languages/r.js"></script>
    <script language="javascript" type="text/javascript" src="msg/js/en.js"></script>

    <!-- DataForge, Vega-Lite, and what-not -->
    <script src="https://cdn.jsdelivr.net/npm/vega@5.4.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@3.3.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@4.2.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.0.2/papaparse.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/data-forge@1.7.2/dist/web/index.js"></script>

    <!-- Put all blocks code in a div so it's easy to find and load for testing. -->
    <div id="tidyblocks">
      <!-- TidyBlocks supports -->
      <script src="utilities/tb_dataframe.js"></script>
      <script src="utilities/tb_manager.js"></script>
      <script src="utilities/tb_codegen.js"></script>
      <script src="utilities/tb_runtime.js"></script>
      <script src="utilities/tb_gui.js"></script>
      <script src="utilities/tb_themes.js"></script>

      <!-- TidyBlocks blocks -->

      <script src="blocks/data_colors.js"></script>
      <script src="generators/js/data_colors.js"></script>
      <script src="generators/r/data_colors.js"></script>

      <script src="blocks/data_earthquakes.js"></script>
      <script src="generators/js/data_earthquakes.js"></script>
      <script src="generators/r/data_earthquakes.js"></script>

      <script src="blocks/data_iris.js"></script>
      <script src="generators/js/data_iris.js"></script>
      <script src="generators/r/data_iris.js"></script>

      <script src="blocks/data_mtcars.js"></script>
      <script src="generators/js/data_mtcars.js"></script>
      <script src="generators/r/data_mtcars.js"></script>

      <script src="blocks/data_toothGrowth.js"></script>
      <script src="generators/js/data_toothGrowth.js"></script>
      <script src="generators/r/data_toothGrowth.js"></script>

      <script src="blocks/data_unit.js"></script>
      <script src="generators/js/data_unit.js"></script>
      <script src="generators/r/data_unit.js"></script>

      <script src="blocks/data_urlCSV.js"></script>
      <script src="generators/js/data_urlCSV.js"></script>
      <script src="generators/r/data_urlCSV.js"></script>

      <script src="blocks/dplyr_filter.js"></script>
      <script src="generators/js/dplyr_filter.js"></script>
      <script src="generators/r/dplyr_filter.js"></script>

      <script src="blocks/dplyr_groupby.js"></script>
      <script src="generators/js/dplyr_groupby.js"></script>
      <script src="generators/r/dplyr_groupby.js"></script>

      <script src="blocks/dplyr_mutate.js"></script>
      <script src="generators/js/dplyr_mutate.js"></script>
      <script src="generators/r/dplyr_mutate.js"></script>

      <script src="blocks/dplyr_select.js"></script>
      <script src="generators/js/dplyr_select.js"></script>
      <script src="generators/r/dplyr_select.js"></script>

      <script src="blocks/dplyr_summarize.js"></script>
      <script src="generators/js/dplyr_summarize.js"></script>
      <script src="generators/r/dplyr_summarize.js"></script>

      <script src="blocks/ggplot_bar.js"></script>
      <script src="generators/js/ggplot_bar.js"></script>

      <script src="blocks/ggplot_boxplot.js"></script>
      <script src="generators/js/ggplot_boxplot.js"></script>

      <script src="blocks/ggplot_hist.js"></script>
      <script src="generators/js/ggplot_hist.js"></script>

      <script src="blocks/ggplot_point.js"></script>
      <script src="generators/js/ggplot_point.js"></script>

      <script src="blocks/ggplot_table.js"></script>
      <script src="generators/js/ggplot_table.js"></script>

      <script src="blocks/plumbing_join.js"></script>
      <script src="generators/js/plumbing_join.js"></script>

      <script src="blocks/plumbing_notify.js"></script>
      <script src="generators/js/plumbing_notify.js"></script>

      <script src="blocks/stats_arithmetic.js"></script>
      <script src="generators/js/stats_arithmetic.js"></script>

      <script src="blocks/stats_count.js"></script>
      <script src="generators/js/stats_count.js"></script>

      <script src="blocks/stats_max.js"></script>
      <script src="generators/js/stats_max.js"></script>

      <script src="blocks/stats_mean.js"></script>
      <script src="generators/js/stats_mean.js"></script>
      <script src="generators/r/stats_mean.js"></script>

      <script src="blocks/stats_median.js"></script>
      <script src="generators/js/stats_median.js"></script>

      <script src="blocks/stats_min.js"></script>
      <script src="generators/js/stats_min.js"></script>

      <script src="blocks/stats_sd.js"></script>
      <script src="generators/js/stats_sd.js"></script>

      <script src="blocks/stats_sum.js"></script>
      <script src="generators/js/stats_sum.js"></script>

      <script src="blocks/variable_column.js"></script>
      <script src="generators/js/variable_column.js"></script>

      <script src="blocks/variable_columns.js"></script>
      <script src="generators/js/variable_columns.js"></script>

      <script src="blocks/variable_compare.js"></script>
      <script src="generators/js/variable_compare.js"></script>
      <script src="generators/r/variable_compare.js"></script>

      <script src="blocks/variable_number.js"></script>
      <script src="generators/js/variable_number.js"></script>

      <script src="blocks/variable_logical.js"></script>
      <script src="generators/js/variable_logical.js"></script>

      <script src="blocks/variable_text.js"></script>
      <script src="generators/js/variable_text.js"></script>
    </div>
    
    <script>
      // Initialize display and set up Blockly after DOM content is solid.
      // This script is here instead of in the utilities file so that it
      // *won't* be run when loading those files for testing.
      document.addEventListener('DOMContentLoaded', (event) => {
        initializeDisplay()
        setUpBlockly()
      })
    </script>
  </body>
</html>
