<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- Visual appearance -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="static/tidyblocks.css" rel="stylesheet" type="text/css">

  </head>
  <body>
  
    <div id="codeArea">
      <button id="blockToText" onclick="generateCodePane(); showCode();">
        As Text
        <i class="fa fa-bug"></i>
      </button>
      <button id="runCode" onclick="runCode()">
        Run
        <i class="fa fa-play"></i>
      </button>
      <br/>
      <input type="text" id="filename" name="filename" />
      <a id="download" href="#" onclick="saveCode()"><button>Download</button></a>
      <input type="file" onchange="loadCode(this.files)"/>
      <a href="./guide/"><i class="fa fa-info-circle"></i> Guide</a>
      <div class="input" id="blockDisplay">
        <xml id="toolbox">
          <category name="data" categorystyle="data">
            <block type="data_colors"></block>
            <block type="data_double"></block>
            <block type="data_earthquakes"></block>
            <block type="data_iris"></block>
            <block type="data_mtcars"></block>
            <block type="data_toothGrowth"></block>
            <block type="data_single"></block>
            <block type="data_urlCSV"></block>
          </category>
          <category name="transform" categorystyle="transform">
            <block type="transform_filter"></block>
            <block type="transform_groupBy"></block>
            <block type="transform_mutate"></block>
            <block type="transform_select"></block>
            <block type="transform_sort"></block>
            <block type="transform_summarize"></block>
            <block type="transform_ungroup"></block>
          </category>
          <category name="plot" categorystyle="plot">
            <block type="plot_bar"></block>
            <block type="plot_boxplot"></block>
            <block type="plot_hist"></block>
            <block type="plot_point"></block>
            <block type="plot_table"></block>
          </category>
          <category name="plumbing" categorystyle="plumbing">
            <block type="plumbing_join"></block>
            <block type="plumbing_notify"></block>
          </category>
          <category name="values" categorystyle="values">
            <block type="value_arithmetic"></block>
            <block type="value_boolean"></block>
            <block type="value_column"></block>
            <block type="value_compare"></block>
            <block type="value_convert"></block>
            <block type="value_datetime"></block>
            <block type="value_ifElse"></block>
            <block type="value_negate"></block>
            <block type="value_not"></block>
            <block type="value_number"></block>
            <block type="value_logical"></block>
            <block type="value_text"></block>
            <block type="value_type"></block>
          </category>
        </xml>
      </div>
      <div class="input" id="codeOutputDiv">
        <pre id="codeOutput"></pre>
      </div>
    </div>
    
    <div id="displayArea">
      <div class="output" id="plotOutput">
        Plot Output
      </div>
      <div id="tabArea">
        <div class="tab">
          <button id="dataButton" class="tablink active" onclick="displayTab(event, 'data')">Data Output</button>
          <button id="errorButton" class="tablink" onclick="displayTab(event, 'error')">Error Output</button>
        </div>
      </div>
      <div class="tabcontent" id="data">
        <div id="dataOutput"></div>
      </div>
      <div class="tabcontent" id="error">
        <p>Error Goes Here</p>
      </div>
    </div>

    <!-- Blockly itself -->
    <script language="javascript" type="text/javascript" src="static/blockly_compressed.js"></script>
    <script language="javascript" type="text/javascript" src="static/blocks_compressed.js"></script>
    <script language="javascript" type="text/javascript" src="static/javascript_compressed.js"></script>
    <script language="javascript" type="text/javascript" src="static/msg/js/en.js"></script>

    <!-- DataForge, Vega-Lite, and what-not -->
    <script src="https://cdn.jsdelivr.net/npm/vega@5.4.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@3.3.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@4.2.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.0.2/papaparse.min.js"></script>

    <!-- Put all blocks code in a div so it's easy to find and load for testing. -->
    <div id="tidyblocks">
      <!-- TidyBlocks supports -->
      <script src="tidyblocks/tidyblocks.js"></script>
      <script src="tidyblocks/gui.js"></script>
      <script src="tidyblocks/themes.js"></script>

      <!-- TidyBlocks blocks -->

      <script src="blocks/data_colors.js"></script>
      <script src="generators/js/data_colors.js"></script>

      <script src="blocks/data_double.js"></script>
      <script src="generators/js/data_double.js"></script>

      <script src="blocks/data_earthquakes.js"></script>
      <script src="generators/js/data_earthquakes.js"></script>

      <script src="blocks/data_iris.js"></script>
      <script src="generators/js/data_iris.js"></script>

      <script src="blocks/data_mtcars.js"></script>
      <script src="generators/js/data_mtcars.js"></script>

      <script src="blocks/data_toothGrowth.js"></script>
      <script src="generators/js/data_toothGrowth.js"></script>

      <script src="blocks/data_single.js"></script>
      <script src="generators/js/data_single.js"></script>

      <script src="blocks/data_urlCSV.js"></script>
      <script src="generators/js/data_urlCSV.js"></script>

      <script src="blocks/transform_filter.js"></script>
      <script src="generators/js/transform_filter.js"></script>

      <script src="blocks/transform_groupby.js"></script>
      <script src="generators/js/transform_groupby.js"></script>

      <script src="blocks/transform_mutate.js"></script>
      <script src="generators/js/transform_mutate.js"></script>

      <script src="blocks/transform_select.js"></script>
      <script src="generators/js/transform_select.js"></script>

      <script src="blocks/transform_sort.js"></script>
      <script src="generators/js/transform_sort.js"></script>

      <script src="blocks/transform_summarize.js"></script>
      <script src="generators/js/transform_summarize.js"></script>

      <script src="blocks/transform_ungroup.js"></script>
      <script src="generators/js/transform_ungroup.js"></script>

      <script src="blocks/plot_bar.js"></script>
      <script src="generators/js/plot_bar.js"></script>

      <script src="blocks/plot_boxplot.js"></script>
      <script src="generators/js/plot_boxplot.js"></script>

      <script src="blocks/plot_hist.js"></script>
      <script src="generators/js/plot_hist.js"></script>

      <script src="blocks/plot_point.js"></script>
      <script src="generators/js/plot_point.js"></script>

      <script src="blocks/plot_table.js"></script>
      <script src="generators/js/plot_table.js"></script>

      <script src="blocks/plumbing_join.js"></script>
      <script src="generators/js/plumbing_join.js"></script>

      <script src="blocks/plumbing_notify.js"></script>
      <script src="generators/js/plumbing_notify.js"></script>

      <script src="blocks/value_arithmetic.js"></script>
      <script src="generators/js/value_arithmetic.js"></script>

      <script src="blocks/value_boolean.js"></script>
      <script src="generators/js/value_boolean.js"></script>

      <script src="blocks/value_column.js"></script>
      <script src="generators/js/value_column.js"></script>

      <script src="blocks/value_compare.js"></script>
      <script src="generators/js/value_compare.js"></script>

      <script src="blocks/value_convert.js"></script>
      <script src="generators/js/value_convert.js"></script>

      <script src="blocks/value_datetime.js"></script>
      <script src="generators/js/value_datetime.js"></script>

      <script src="blocks/value_ifelse.js"></script>
      <script src="generators/js/value_ifelse.js"></script>

      <script src="blocks/value_negate.js"></script>
      <script src="generators/js/value_negate.js"></script>

      <script src="blocks/value_not.js"></script>
      <script src="generators/js/value_not.js"></script>

      <script src="blocks/value_number.js"></script>
      <script src="generators/js/value_number.js"></script>

      <script src="blocks/value_logical.js"></script>
      <script src="generators/js/value_logical.js"></script>

      <script src="blocks/value_text.js"></script>
      <script src="generators/js/value_text.js"></script>

      <script src="blocks/value_type.js"></script>
      <script src="generators/js/value_type.js"></script>
    </div>

    <!-- R code
    <script language="javascript" type="text/javascript" src="languages/r.js"></script>
    <script src="generators/r/data_colors.js"></script>
    <script src="generators/r/data_earthquakes.js"></script>
    <script src="generators/r/data_iris.js"></script>
    <script src="generators/r/data_mtcars.js"></script>
    <script src="generators/r/data_toothGrowth.js"></script>
    <script src="generators/r/data_single.js"></script>
    <script src="generators/r/data_urlCSV.js"></script>
    <script src="generators/r/transform_filter.js"></script>
    <script src="generators/r/transform_groupby.js"></script>
    <script src="generators/r/transform_mutate.js"></script>
    <script src="generators/r/transform_select.js"></script>
    <script src="generators/r/transform_summarize.js"></script>
    <script src="generators/r/value_compare.js"></script>
    -->

    <script>
      // Initialize display and set up Blockly after DOM content is solid.
      // This script is here instead of in the utilities file so that it
      // *won't* be run when loading those files for testing.
      document.addEventListener('DOMContentLoaded', (event) => {
        initializeDisplay()
        setUpBlockly()
      })
    </script>
  </body>
</html>
